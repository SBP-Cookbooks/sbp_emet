<?xml version="1.0"?>
<!--
# $Id: Generated by chef for node: <%= node['hostname'] %>
# # =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# # NOTE: This file is controlled by chef templates!
# #   Do not edit or change this file but change the following:
# #    * template file: <%= @template_file %>
# #    * recipe file: <%= @recipe_file %>
# # =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# # Schuberg Philis 2014
# # =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# -->

<EMET_Standard_Rules>

<DefaultConfig>
  <Mitigations>
   <% @config['mitigation'].each do |name,value| -%>
   <Mitigation Name="<%= name %>" Enabled="<%= value %>" />
   <% end -%>
  </Mitigations>
</DefaultConfig>

<Settings>
 <ExploitAction Value="<%= @config['exploit_action'] %>" />
 <AdvancedSettings <% @config['advanced_settings'].each do |name,value| -%><%= name %>="<%= value %>" <% end -%>/>
 <SystemSettings <% @config['system_settings'].each do |name,value| -%><%= name %>="<%= value %>" <% end -%>/>
 <Reporting <% @config['reporting_settings'].each do |name,value| -%><%= name %>="<%= value %>" <% end -%>/>
</Settings>

<Vendor Name="SchubergPhilis Best Practise">
<% @config['process'].each do |process,info| -%>
<Product Name="<%= process %>">
 <Version Path="<%= info['path']%>">
  <% if !info['mitigations'].nil? -%>
  <% info['mitigations'].each do |name,value| -%>
  <Mitigation Name="<%= name %>"  Enabled="<%= value %>"/>
  <% end -%>
  <% end -%>
 </Version>
</Product>
<% end -%>
</Vendor>

</EMET_Standard_Rules>

